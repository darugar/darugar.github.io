<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Non-Technical Explanation of ChatGPT: Deep Learning - Parand</title>
    <link rel="shortcut icon" type="image/png" href="/theme/images/favico.png"/>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans">
    <link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600" data-optimized-fonts="true">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
        body {
          font-family: "EB Garmond",warnock-pro,Palatino,"Palatino Linotype","Palatino LT STD","Book Antiqua",Georgia,serif;
        }
        h1 { 
          font-size: x-large !important;
          font-weight: bold !important;
        }
        h2 { 
          font-size: larger !important;
          font-weight: bold !important;
        }
        div.highlight code {
          border: 1px solid #AAA;
          background-color: #fff !important;
          font-size: medium !important;
        }
        table.dataframe {
          background-color: #fff !important;
          font-family: monospace !important;
        }
        table.dataframe th {
          text-align: left !important;
          padding-right: 5px;
        }
        section.article a {
          color: brown !important;
        }

        .article-summary h1, .article-summary p {
          margin-top: 10px !important;
        }
    </style>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XGEBWVBEKP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XGEBWVBEKP');
</script>

<link rel="canonical" href="https://www.parand.com/drafts/a-non-technical-explanation-of-chatgpt-deep-learning.html" />

</head>


<body>
  
<div id="root" class="container py-2 mx-auto text-lg bg-gray-100 rounded max-w-6xl">

    <header class="text-gray-100 body-font bg-gray-700">
        <div class="container mx-auto flex flex-wrap p-5 flex-col md:flex-row items-center text-xl bg-[url('/theme/images/header-bg-1-1920.jpg')]">
          <a class="flex title-font font-medium items-center text-gray-100 mb-4 md:mb-0" href="/">
            <img width=180 src="/theme/images/logo-parand.png">
            <span class="ml-5 text-3xl">Standard Deviations</span>
          </a>
          <nav class="md:ml-auto flex flex-wrap items-center justify-center text-2xl">
            <a class="mr-5 hover:text-gray-400" href="/">Blog</a>
            <a class="mr-5 hover:text-gray-400" href="/pages/writings.html">Writings</a>
            <a class="mr-5 hover:text-gray-400" href="/pages/parand-tony-darugar.html">About</a>
          </nav>
        </div>
    </header>

    <section class="text-gray-600 body-font overflow-hidden">
        <div class="container px-5 py-10 mx-auto">
            <div class="-my-8 divide-y-2 divide-gray-100">

<div class="content-article">

  <div class="py-8 row">
    <a href="drafts/a-non-technical-explanation-of-chatgpt-deep-learning.html" class="text-3xl font-medium text-gray-900 title-font mb-2">A Non-Technical Explanation of ChatGPT: Deep Learning</a>
    <header class="header-article">
        <div class="text-sm">Mon 01 May 2023</div>
    </header>
  </div>

    <section class='article'>
        
        <!-- div class="entry-summary">
            <p>This is part two of the <a href="https://www.parand.com/a-non-technical-explanation-of-chatgpt.html">non-technical explanation of ChatGPT</a> series, please read that first. It's also helpful to read the <a href="https://www.parand.com/a-completely-non-technical-explanation-of-ai.html">non-technical explanation of AI</a> so you have some background on how deep learning is used here.</p>
<h1>Creating CatGPT</h1>
<p>Convinced that Markov's method is a good path forward, you decide â€¦</p>
        </div -->
    
        <div class="entry-content space-y-5">
            <p>This is part two of the <a href="https://www.parand.com/a-non-technical-explanation-of-chatgpt.html">non-technical explanation of ChatGPT</a> series, please read that first. It's also helpful to read the <a href="https://www.parand.com/a-completely-non-technical-explanation-of-ai.html">non-technical explanation of AI</a> so you have some background on how deep learning is used here.</p>
<h1>Creating CatGPT</h1>
<p>Convinced that Markov's method is a good path forward, you decide to create the frequency table with 4 words 
of context for the alien cat language so you can create high quality sentences. You roll up your sleaves and get to work.</p>
<p>A week goes by and you notice you've barely made a dent - you've filled up several notebooks with
frequency counts, and you still have so very many word combinations to go through. What's going on?</p>
<p>How much work is necessary to create the frequency table? If we were using a single word 
as our context window and wanted to have the vocabulary of an average native English speaker (30000 words),
we'd need 30000 rows, one for each word in the English language. </p>
<p>If we use two words of context we'd potentially be looking at the number of two word permutations of those 
30k words. That's about 900 million rows. With three words of context we could have 27 trillion
rows. That's a lot of rows. In practice the number of permutations is significantly smaller because many word 
permutations don't occur in English, but we'd still get to very large numbers very quickly.</p>
<p>This is an unfortunate reality when dealing with combinations and permutations - increasing
the number of items you consider catastrophically increases the number of calculations you have
to do or items you have to remember. The technical term is <a href="https://en.wikipedia.org/wiki/Combinatorial_explosion"><em>combinatorial explosion</em></a>, which is a good description of how your head feels after all that counting.</p>
<p><img src="/static/images/cat-fireworks.png"></p>
<p>This is not good. Four words of context is not very much - something as simple as our marathon example
( I just ran a marathon. I am very _____ ) would require more context. How do we deal with the explosion?</p>
<p>You ask Markov and he gets a sour look on his face - "Yeah, this is a a problem. I don't have a great solution".</p>
<h1>Learning, Deeply</h1>
<p>Maybe we can use 
<a href="https://www.parand.com/a-completely-non-technical-explanation-of-ai.html">our experience from finding cats</a> here. 
That also seemed a very complex problem, and we solved that using layers of workers to focus on different aspects
of the problem, and formed our final opinion based on the opinions of the layers of workers giving
us information.</p>
<p>We have a bit of a problem though - in that case the boss was giving us the examples as well as the correct
answers. She was also giving us rewards and punishments. We don't have that here - we just have a big book of alien cat communication and a desire to create a frequency table.</p>
<p>That's too bad - you have your slapping gloves ready to go, you were really hoping you could use the same
technique as last time.</p>
<h1>Eureka: We can Train</h1>
<p>What is the actual problem we're trying solve with the frequency table? We are trying to predict the next
word. Can we turn that into a problem with rewards and punishments?</p>
<p>Yes we can!</p>
<p>The problem we're trying to solve is: given 4 words of context, predict the next word. We tried to be
clever and use a frequency table to solve this. Let's not be clever: just like the cat classification
task, let's not define the methods and process for solving the problem - let's instead hand it
off to our layers of workers and reward and punish them until they figure it out.</p>
<p>How do we turn our book of cat communication into a prediction task? Simple: grab 4 words of context 
and hand them off to the group of workers and ask them to predict the next word. We know what the 
next word should be (it's just the word that followed those words in the big book of cat communication) -
if they get it right we give them a reward, if they get it wrong we give them a slap.</p>
<p>This is great - we can open the book of alien cat communication on any page, pick 4 words, give that
to the workers, and train them on what the next word should be. Now we have our training examples
and our rewards and punishments.</p>
<p>You grab your slapping gloves and lots of rewards and call your layers of trusty workers and start
the the training.</p>
<h1>It Works. Sort Of</h1>
<p>After lots of training you and your colleagues are getting good at predicting the next word
in the cat language, and you're enjoying the rewards. But you're a bit stuck - there's only
so much you can do with 4 words of context. Your colleagues are asking for more and more words
of context. You start to increase the context window from 4 words to 5, 6, and so on, and your 
responses start getting better. But the workers' task is also getting much more complex: as 
you give people more and more words their area of focus becomes too large - they have too many 
foreign words to look at at a time. You get to a point where each worker can't effectively focus 
on more words. Your training stalls and you're not getting as much reward as you want. Your 
colleagues start complaining about losing out on the rewards - the loss is too high!</p>
<h1>Attention Please!</h1>
<p>Your context window has gotten too large and things are stalling. You start doing the same thing
you did with the cat classifying task: you tell each worker to focus on a small window of
words and give their opinion on that instead of looking at all the words in the context. It's
going ok, but the window of words each worker looks at isn't enough to understand the whole
context, and increasing each worker's window makes their individual task too difficult.</p>
<p>One day one of the workers, frustrated that she can't predict the next
word, yells out "I think this word is an adverb. I can't predict the next word -  I don't
have a verb in the part of the context I'm looking at!"</p>
<p>One of the other workers looks up. "I have a verb in my part! I've been looking for an adverb!"</p>
<p>The two of them exchange information and both improve their predictions.</p>
<p>Why didn't you think of that? You should let the workers communicate about the parts they're
looking into. You grab your English grammar book and start telling the workers they should 
call out the parts of speech they have. </p>
<p>The problem is cat language doesn't follow English grammar rules, so what you're asking
for doesn't really make sense.</p>
<p>You remember your motto: don't solve the problem in a clever way, just provide rewards and
punishments. You tell the workers: feel free to tell others the type of thing you're looking 
at and ask others for the information you need to predict the next word. </p>
<p>"What do you mean by <em>type of thing you're looking at</em>?" ask the workers.</p>
<p>"I have no idea", you respond. "Whatever helps you."</p>
<p>The workers are skeptical, but they decide to give it a try. They start telling others what
they think is relevant in the group of words they're looking at and paying attention to what 
the others are saying. It's challenging - each worker has to decide what to to say about
their piece and what pay attention to from others - but they work out a system. 
"I think this has something to do with whiskers, and I'm looking 
for something about whether the cat's in a small or large space". "I have information about
the cat being alone and I'm trying to see if they're scared or not". "My tail is low between
my legs, does anyone have information about a threat?"</p>
<p>A lot of what they communicate isn't useful, so they don't get rewarded for it. The workers 
focus on the information gives them the most rewards, and because the rewards come from the 
next-word prediciton being right the whole system starts producing internal information that
leads to better predictions.</p>
<p>Your training has gotten to the point where you're barely losing any rewards. You want 
to make sure people aren't just memorizing the whole cat communication book, so you kept
one part of the book secret during training, and you use that part to test how good 
your next-word prediction is. It's looking good. </p>
<p>You have successfully built a Large (Cat) Language Model.</p>
<h1>Cat Communication</h1>
<p>You decide to try it out with the alien cats.</p>
<p><img src="/static/images/alien-cat.png"></p>
<p>The cat representative is sitting across from you. It says something. You hand that over
to your team of colleagues and they start their process of creating a response, one word
at a time. </p>
<p>You give your response to the cat. </p>
<p>It gives you a surprised look, and raises its tail in a let's-be-friends gesture.</p>
<p>Back and forth, you try several exchanges, and it seems to be working - you're able to have
a "conversation". You're not sure what you or the cat are saying, but you're conversing.</p>
<p>You notice some of your responses seem to upset the cat. You'd like to avoid that, so you
start giving feedback to your team, increasing rewards for responses that make the cat
happy and reducing rewards for responses that upset the cat. You call this Cat-in-Loop-Training.</p>
<p>You have saved humanity, communicated with alients, and created CatGPT.</p>
<h1>Postscript</h1>
<p>We can talk about </p>
        </div>
    </section>
    <footer class="footer-article py-8">
        <div class="tags-and-categories"><span class="italic">Category: </span><a href="https://www.parand.com/category/machine-learning.html">Machine Learning</a>
| <span class="italic">Tags:</span> <a class="inline-block py-1 px-2 rounded bg-indigo-50 text-indigo-500 text-base font-medium tracking-widest" href="https://www.parand.com/tag/explainer.html">explainer </a><a class="inline-block py-1 px-2 rounded bg-indigo-50 text-indigo-500 text-base font-medium tracking-widest" href="https://www.parand.com/tag/machine-learning.html">machine-learning </a><a class="inline-block py-1 px-2 rounded bg-indigo-50 text-indigo-500 text-base font-medium tracking-widest" href="https://www.parand.com/tag/llm.html">llm </a>        </div>
    </footer>
    <!-- disqus  -->

  </div>
            </div>
            </div>
          </div>
        </div>
    </section>

</div>


</body>
</html>