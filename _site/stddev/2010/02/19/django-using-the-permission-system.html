<html>
<head>
    <link rel="stylesheet" href="/css/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/parand.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans|Italianno' rel='stylesheet' type='text/css'>
    <title>Django: Using The Permission System</title>
</head>

<body>

<div class="container">
    <div class="row navigation">
        <div class="span3">
            Parand Tony Darugar
        </div>
        <div class="span8 offset1">
            <span class="nav right"><a href="">About me</a></span>
            <span class="nav right"><a href="http://twitter.com/parand/">@parand</a></span>
            <span class="nav right">s@parand.com</span>
            <!-- span class="nav right"><input type="text" class="input-medium search-query"></span -->
            
        </div>
    </div>

    <div class="row headerrow">
        <div class="span7 heading"><a href="">Django: Using The Permission System</a></div>
        <div class="span5 subheading text-right">A Cruel and Petty Dictator</div>
    </div>

    <!-- CONTENT -->
    <div class="row content">
        <div class="span12">
<p>I was surprised at how little information I found on making use of Django&#8217;s permission system. Here are some quick notes on one way to use it:</p>

<p><em>Groups</em> are groups of users. For example, you could define a group of users who have premium accounts, or have been verified in some way, or are somehow special:</p>

<pre><code>from django.contrib.auth.models import Group, Permission
special_users = Group(name=&#39;Special Users&#39;)
special_users.save()
really_special_users = Group(name=&#39;Super Special Users&#39;)
really_special_users.save()</code></pre>

<p>Now you have two groups defined and can define permissions for them. Django associates permissions with models (note: not model instances, but models). You&#8217;ll need to select a model to apply the permissions to, and do a small dance with &#8220;ContentType&#8221; to find that model&#8217;s content type:</p>

<pre><code>from django.contrib.contenttypes.models import ContentType
somemodel_ct = ContentType.objects.get(app_label=&#39;myapp&#39;, model=&#39;somemodel&#39;)

can_view = Permission(name=&#39;Can View&#39;, codename=&#39;can_view_something&#39;,
                       content_type=somemodel_ct)
can_view.save()

can_modify = Permission(name=&#39;Can Modify&#39;, codename=&#39;can_modify_something&#39;,
                       content_type=somemodel_ct)
can_modify.save()</code></pre>

<p>You&#8217;ve now defined two permissions and can associate them with your Groups:</p>

<pre><code>special_users.permissions.add(can_view)
really_special_users.permissions = [can_view, can_modify]</code></pre>

<p>Our groups and their associated permissions are ready to go. Now we just have to associate these permissions with users:</p>

<pre><code>jack=User.objects.get(email=&#39;[[email protected]](/web/20120325165629/http://cloudflare.com/email-protection.html)&#39;)
jack.groups.add(special_users)

jill=User.objects.get(email=&#39;[[email protected]](/web/20120325165629/http://cloudflare.com/email-protection.html)&#39;)
jill.groups.add(really_special_users)</code></pre>

<p>We&#8217;re all done. Now we can check the users&#8217; permissions:</p>

<pre><code>&gt;&gt;&gt; jack.has_perm(&#39;myapp.can_view_something&#39;)
True
&gt;&gt;&gt; jack.has_perm(&#39;myapp.can_modify_something&#39;)
False

&gt;&gt;&gt; jill.has_perm(&#39;myapp.can_view_something&#39;)
True
&gt;&gt;&gt; jill.has_perm(&#39;myapp.can_modify_something&#39;)
True</code></pre>

<p>And to use it in your templates:</p>

<pre><code>Can&#39;t show you!</code></pre>
        </div>
    </div>

    <!-- div class="row contents">
        <div class="span12">
            <img class="img-polaroid" src="http://farm5.staticflickr.com/4148/5066965098_f73170bbf6_b.jpg">
        </div>
    </div>


    <div class="row contents">
        <div class="span12">
<em>What about our student loans?</em> asked one of the students.
        </div>
    </div -->

    <div class="row contents">
        <div class="span12 signature">
            Parand Tony Darugar - 19 Feb 2010
        </div>
    </div>

    <div class="row titlerow">
        <div class="span9 title">More:</div>
    </div>
    <div class="row ">
        <div class="span9 title">&raquo; Martin the Silly Rainbow</div>
        <div class="span3 title-details text-right">January 1st, 2013</div>
    </div>
    <div class="row ">
        <div class="span9 title">&raquo; If I Fell In Love With You</div>
        <div class="span3 title-details text-right">November 16th, 2013</div>
    </div>

</div>

</body>

</html>
